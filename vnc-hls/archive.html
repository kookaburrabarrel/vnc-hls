<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Archived Clips</title>
  <style>
    body { font-family: sans-serif; background: #111; color: #fff; padding: 2em; }
    select, button { padding: 0.5em; font-size: 1em; }
    ul { list-style: none; padding: 0; }
    li { margin: 0.5em 0; }
    a { color: #4cf; text-decoration: none; }
    a:hover { text-decoration: underline; }
  </style>
</head>
<body>
  <h1>Archived Clips</h1>
  <label for="laneSelect">Select lane:</label>
  <select id="laneSelect">
    <option value="lane1">lane1</option>
    <option value="lane2">lane2</option>
    <option value="lane3">lane3</option>
    <option value="lane4">lane4</option>
  </select>
  <button onclick="loadClips()">Load Clips</button>
  <ul id="clipList"></ul>

  <script>
    async function loadClips() {
      const lane = document.getElementById("laneSelect").value;
      const list = document.getElementById("clipList");
      list.innerHTML = "<li>Loading...</li>";
      try {
        const res = await fetch(`/archive/${lane}/`);
        const text = await res.text();
        const matches = [...text.matchAll(/href="([^"]+\.mp4)"/g)].map(m => m[1]);
        if (!matches.length) {
          list.innerHTML = "<li>No clips found.</li>";
        } else {
          list.innerHTML = "";
          matches.forEach(file => {
            const item = document.createElement("li");
            const link = document.createElement("a");
            link.href = `/archive/${lane}/${file}`;
            link.textContent = file;
            link.download = file;
            item.appendChild(link);
            list.appendChild(item);
          });
        }
      } catch (err) {
        list.innerHTML = "<li>Failed to fetch clips.</li>";
      }
    }
  </script>
</body>
</html>
